### Информация об ИИ
![aire](https://github.com/feravolt/FDE.AI-docs/blob/master/aire.png?raw=true)

Как намекает название, в приложении есть реальный ИИ. Его смысл в том, чтобы понимать сценарии использования устройства и исходя из этого подгонять различные настройки системы. Также логика ИИ тесно завязана на температуру устройства. 
Все действия ИИ отображаются в чате. Главный плюс ИИ - нет дополнительного расхода энергии.

#### Включается из настроек:
**Force Doze**:\
Опция доступна для устройств с Android 6.0 и новее (ВЫКЛ по умолчанию). При выключенном экране устройство принудительно переводится в режим глубокого сна (Doze), а через 3 секунды принудительный режим отменяется и работа Doze продолжается в штатном режиме, оставляя устройство спать.

**Переключатель троттлинга**:\
Опция выключена по умолчанию. Она включает и отключает троттлинг для ЦП и видеоускорителя. Когда троттлинг отключен - устройство может перегреваться, но производительность будет максимальной даже при длительных нагрузках. Это также может замедлить быструю зарядку/камеру. Троттлинг будет автоматически включен на время независимо от настройки когда устройство заряжается или температура устройства слишком высока.

**Постоянный буст тяжелых игр/приложений:**\
Опция выключена по умолчанию. Отвечает за работу турбо режимов ИИ. Когда опция активирована, ИИ будет постоянно держать режимы турбо активными, повышать приоритет процесса и временно отключать троттлинг (если он не был отключен пользователем и следуя всем правилам контроллера температуры и зарядки) для игр/приложений из списка `/gamelist` во время их работы. Используйте `/gamelistadd имяпакета` чтобы добавить свои игры в список ускорения.

#### Включается само когда возможно:
**GPU Turbo**:\
При запуске ИИ определит, может ли GPU Turbo работать на вашем устройстве и напишет об этом в лог. ИИ будет наблюдать за уровнем нагрузки видеоускорителя. При продолжительной высокой нагрузке ИИ поднимет частоты до максимума до следующей проверки (примерно 30 секунд). Как только нагрузка упадет, вернутся стоковые значения. 
Данная функция не увеличит фреймрейт, но сделает его более стабильным, потому что регулировщику частот ГП не придется "прыгать" по частотам при смене нагрузки, что и должно положительно сказаться на стабильности FPS. Здесь нет привязки к имени приложения - логика универсальна, нагрузка GPU измеряется напрямую, не важно что его нагружает (игра, бенчмарк и т.п.). GPU Turbo не будет конфликтовать с одноименной логикой от Huawei. При повышении температуры устройства порог срабатывания GPU Turbo будет повышен, чтобы избежать перегрева устройства.
Работает только при включенном экране, при выключенном частоты возвращаются в стоковые значения. Поддерживается на большинстве видеоускорителей Adreno и Mali.

**Legacy GPU Turbo**:\
Данный режим определяется в случае если драйвер в ядре не предоставляет информации о нагрузке GPU. Отличием от обычного GPU Turbo является то, что ускорение будет происходить опираясь не на нагрузку GPU в реальном времени, а на наличие работы 'тяжелого' процесса/игры из списка `/gamelist`. Следовательно, для автоматической работы этого режима необходимо активировать опцию принудительного буста тяжелых игр в настройках. Вы также можете активировать постоянный режим Legacy GPU turbo вручную переключив режим ИИ на производительность.
Работает только при включенном экране, при выключенном частоты возвращаются в стоковые значения. Поддерживается на некоторых видеоускорителях Mali и Vivante.

**Framebuffer boost**:\
При запуске ИИ определит, может ли Framebuffer boost работать на вашем устройстве и напишет об этом в лог. На данный момент эта логика будет использоваться только если есть поддержка GPU Turbo. Framebuffer boost - это ускорение буфера кадров. При ускорении поднимаются частоты кадрового буфера. При активном использовании GPU (нагрузка более 30%) framebuffer boost будет активироваться автоматически, а в результате работы частота обновления экрана будет максимально стабильна.
Работает только при включенном экране, при выключенном частоты возвращаются в стоковые значения. Поддерживается на большинстве устройств с SoC Qualcomm.

**CPU Turbo**:\
При запуске ИИ определит, может ли CPU Turbo работать на вашем устройстве и напишет об этом в лог. ИИ будет наблюдать за уровнем нагрузки ЦП. При продолжительной высокой нагрузке ИИ поднимет отзывчивость регулировщика ЦП и заставит его держать частоту выше 'high speed freq.' (это примерно половина от максимальной частоты ЦП) до следующей проверки (примерно 30 секунд). В логике нет привязки к имени приложения - нагрузка CPU измеряется напрямую, не важно что его нагружает (игра, бенчмарк и т.п.), делая логику универсальной. Чем выше температура устройства - тем выше порог срабатывания CPU Turbo, чтобы избежать перегрева устройства.
Работает только при включенном экране, при выключенном параметры возвращаются на изначальные значения. Работает с interactive, ondemand, schedutil и основанными на них регуляторами ЦП.

**Машинное обучение**:\
Сейчас машинное обучение (МО) используется только если есть поддержка CPU и/или GPU Turbo. Оно будет изучать как вы используете устройство и подгонять некоторые системные параметры на ходу. Так, если вы много играете - ИИ будет настраивать систему для лучшей производительности. Если вы просто переписываетесь и смотрите видео - ИИ будет настраивать систему для лучшего энергосбережения. Если вы часто делаете и то, и другое - ИИ будет сам решать что делать, для этого и сделано машинное обучение. В приложении FDE можно настроить постоянное предпочтение выбора МО в сторону производительности или энергосбережения.

**Динамическая настройка VM**:\
Каждые ~30 секунд проверяется использование ОЗУ. В зависимости от полученных данных подстраиваются некоторые настройки VM. В результате должно улучшиться управление кешем в оперативной памяти. Так же будет выводиться предупреждение если доступно слишком мало свободной ОЗУ.
Работает только при ВКЛ экране.

**Контроллер температуры**:\
ИИ проверяет температуру устройства и уведомляет в логе, если оно перегревается. Пороги срабатывания CPU/GPU Турбо рассчитываются полагаясь на данные от этой функции. Если устройство будет перегреваться CPU/GPU Турбо перестанет повышать частоты или станет делать это гораздо реже. Если температура устройства сильно повысится, троттлинг будет временно активирован независимо от настроек на время, пока температура немного не спадёт.

**Контроллер зарядки**:\
ИИ проверяет, заряжается устройство или нет. Если оно заряжается, ИИ настраивает VM на производительность. После отключения от зарядки ИИ вернет предыдущий режим которому он 'научился'. Force Doze (если активирован) тоже зависит от этой функции, предотвращая уход в принудительный глубокий сон во время зарядки.
Эта функция не повышает никакие частоты и меняет только настройки VM, поэтому она безопасна и не вызывает дополнительного нагрева устройства. Если будет обнаружено что троттлинг был деактивирован пользователем или ИИ (для тяжёлых игр/приложений), он будет активирован на время пока устройство заряжается.
Так же, в агрессивном режиме ИИ, будет определяться активен ли режим энергосбережения в ОС - если да, ИИ будет автоматически переведен в режим энергосбережения и не будет активировать режим производительности в таком случае.

#### Включается в чате ИИ:
**Адаптивный даунскейл:**\
Опция понижает разрешение экрана до желаемого (заданного пользователем) с целью увеличения производительности GPU. Адаптивность заключается в том, что при изменении разрешения соотношение сторон сохраняется, а DPI меняется, чтобы сохранить размер элементов интерфейса. В итоге изображение остается визуально схожим с оригинальным.
Чтобы сбросить даунскейл используйте команду `/resetscale` в чате ИИ. Так же доступна опция теста даунскейла через чат-команду (см. список команд ниже). Если вдруг что-то пошло не так, попробуйте команду `/resetscale full` в чате - она сбросит значения на аппаратные умолчания.
Опция не принимает значение выше оригинальной ширины экрана и ниже 360 пикселей, а рассчитываемая плотность пикселей не может быть ниже 160 DPI. На некоторых прошивках может давать сбои - используйте аккуратно.

**Продление цикла жизни батареи**:\
Опция выключена по умолчанию. Когда включена, ИИ следит за уровнем заряда батареи устройства и останавливает зарядку батареи на уровне 90% (по умолчанию). Порог срабатывания можно настроить вручную. Зарядка снова активируется если устройство еще подключено к зарядке и уровень батареи упал на 5% от порога срабатывания. Не заряжая батарею на 100% можно продлить жизнь литиевым батареям.

**Автоматическая частота обновления экрана:**\
Опция выключена по умолчанию. Может контролировать частоту обновления экрана для более высокой производительности или энергосбережения в зависимости от сценария использования.
Сперва проверяются поддерживаемые режимы экрана. Для тяжёлых игр/приложений применяется максимальная частота обновления для большей плавности/производительности. Для приложений не требующих высокой производительности (например социальные приложения) применяется минимальная частота обновления для лучшего энергосбережения. В остальных случаях, если экран поддерживает более двух режимов обновления (например, 60 / 90 / 120 Гц), применяется средняя частота обновления (90 Гц из пред. примера). Если экран поддерживает только два режима, применяется максимальная частота обновления.
Работает только если экран поддерживает несколько режимов частот обновления.

**Агрессивный режим ИИ:**\
Опция выключена по умолчанию. Расширяет методы оптимизации системы в реальном времени, что может дать лучшее энергосбережение/производительность в адаптивном режиме ИИ.
Одним из этих методов является автоматическое занижение частоты ЦП (только большого кластера) на ~20% когда ИИ решает переключиться на режим энергосбережения (что уменьшит энергопотребление в ущерб производительности) и повышает частоту обратно до макс. в других режимах.
Эта опция может сильно понизить производительность в режиме энергосбережения или значительно увеличить энергопотребление в режиме производительности - в таком случае просто не используйте её.

**"Чат" с ИИ**: (текст в одну строку - 96 символов)\
Начиная с версии 7 в приложении есть возможность переписываться с ИИ. Это можно расценивать как метод настройки ИИ или просто забавы ради. Распознавание текста происходит поиском по ключевым словам. Настройки в "чате" отражают настройки в меню приложения.
Что может ассистент:
- Показать это сообщение `/help`
- Показать список игр, расцениваемых ИИ как 'тяжелые' `/gamelist`
- Добавлять игры в список 'тяжелых' `/gamelistadd 'имя.пакета.игры'` и очищать этот список `/gamelistclear`
- Закрывать фоновые приложения `/clear ram`
- Очищать кэш-файлы приложений `/clear appscache`
- Дополнительно оптимизировать систему - оптимизировать кэш ART, проверить на ошибки и выполнить TRIM файловой системы `/extraopt`
- Оптимизировать ART кэш с максимальным фильтром оптимизации `/extraopt everything`
- Дополнительно оптимизировать систему автоматически каждый день, если устройство заряжается и экран выключен. ЧЧ это желаемый час времени срабатывания в 24 часовом формате - если оставить пустым, время срабатывания будет установлено на ~05:00 часов. `/extraopt auto ЧЧ` | `/extraopt noauto`
- Чистить Dalvik/ART кэш, отменять изменения оптимизаций кэша `/extraopt revert`
- Переключать опцию закрытия фоновых приложений при выключенном экране `/killbgapps on` | `/killbgapps off`
- Переключать работу датчиков/сенсоров устройства в режиме Doze `/disablesensorsondoze on` | `/disablesensorsondoze off`
- Переключать опцию более глубокой оптимизации системы в реальном времени `/aggressiveai on` | `/aggressiveai off`
- Переключать опцию автоматической смены частоты экрана если поддерживается `/autorefreshrate on` | `/autorefreshrate off`
- Копировать текущий лог FDE.AI в корень внутренней памяти как текстовый файл `/dumpfdelog`
- Переключать вибрацию при выполнении FDE.AI `/vibro off` | `/vibro on`
- Переключать применение всех основных твиков FDE.AI (можно оставить только работу ИИ/турбо) `/alltweaks off` | `/alltweaks on`
- Адаптивно менять разрешение экрана. Если использовать с умом, может значительно улучшить игровую производительность в убыток качеству изображения `/downscale 'желаемая ширина экрана в пикселях'`, например команда `/downscale 720` - понизит разрешение экрана до 720p | `/resetscale` (Так же можно провести тест данной функции, который откатит все изменения через 10 секунд командой `/downscale (например) 720 test`
- Переключать функцию продления цикла жизни батареи `/greenbattery 'опционально, порог срабатывания'` | `/greenbattery off`
- Менять поведение тротлинга во время зарядки устройства `/ignorethrottling on` | `/ignorethrottling off`

